<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NotebookLM åœ–ç‰‡è‡ªå‹•æ‰“åŒ…å·¥å…· - éƒ¨ç½²SOP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background-color: #f8f9fa; /* é¡ä¼¼ Google Sheets çš„èƒŒæ™¯ç° */
        }
        .step-card {
            background-color: #ffffff;
            border: 1px solid #e0e0e0; /* é¡ä¼¼å„²å­˜æ ¼çš„é‚Šæ¡† */
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.03);
        }
        .step-number {
            background-color: #4285F4; /* Google è— */
            color: white;
            border-radius: 50%;
            width: 2.5rem;
            height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.125rem;
            flex-shrink: 0;
        }
        .code-block {
            background-color: #f1f3f4;
            border-radius: 4px;
            padding: 0.5rem 0.75rem;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.875rem;
            color: #3c4043;
            word-break: break-all;
        }
        .code-textarea {
            background-color: #f1f3f4;
            color: #202124;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            border: 1px solid #dadce0;
            resize: vertical;
        }
    </style>
</head>
<body class="p-4 md:p-10">
    <div class="max-w-4xl mx-auto">
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-800">NotebookLM åœ–ç‰‡è‡ªå‹•æ‰“åŒ…å·¥å…·</h1>
            <h2 class="text-xl font-semibold text-gray-600 mt-2">SOP 3.0 éƒ¨ç½²é¢æ¿ (å¯è¤‡è£½ç‰ˆ)</h2>
        </div>

        <!-- ä¸‹è¼‰å€å¡Š -->
        <div class="step-card p-5 mb-6 bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-300">
            <div class="flex items-center justify-between flex-wrap gap-4">
                <div>
                    <h3 class="text-lg font-bold text-gray-800 mb-1">ğŸ“¥ ä¸‹è¼‰æ¡Œé¢å·¥å…·</h3>
                    <p class="text-sm text-gray-600">åœ–ç‰‡å¿«é€Ÿè½‰æª”å·¥å…· - Windows åŸ·è¡Œæª”</p>
                </div>
                <a href="20251105-1142-åœ–ç‰‡å¿«é€Ÿè½‰æª”.exe" 
                   download
                   class="inline-flex items-center px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md hover:shadow-lg transition-all duration-200 transform hover:scale-105">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
                    </svg>
                    ä¸‹è¼‰ .exe æª”æ¡ˆ
                </a>
            </div>
            <p class="text-xs text-gray-500 mt-3">
                ğŸ’¡ æç¤ºï¼šæ­¤å·¥å…·å¯ä»¥å¿«é€Ÿå°‡åœ–ç‰‡è½‰æª”ï¼Œæ–¹ä¾¿ä¸Šå‚³åˆ° Google é›²ç«¯ç¡¬ç¢Ÿå‰ä½¿ç”¨ã€‚
            </p>
        </div>

        <!-- èªªæ˜ -->
        <div class="step-card p-5 mb-6">
            <h3 class="text-lg font-bold text-gray-800 mb-2">éƒ¨ç½²èªªæ˜</h3>
            <p class="text-gray-700">
                é€™æ˜¯ä¸€å¥—ã€Œä¸€æ¬¡æ€§éƒ¨ç½²ã€å·¥å…·ã€‚è«‹ä¾ç…§ä»¥ä¸‹æ­¥é©Ÿï¼Œåœ¨**è‡ªå·±çš„ Google å¸³è™Ÿ**ä¸‹å®Œæˆè¨­å®šã€‚
                <br>
                è¨­å®šå®Œæˆå¾Œï¼Œå°‡ç²å¾—ä¸€å€‹ç€è¦½å™¨æ›¸ç±¤æŒ‰éˆ•ï¼Œå¯ã€Œä¸€éµã€å°‡ Google é›²ç«¯ç¡¬ç¢Ÿè³‡æ–™å¤¾ä¸­çš„æ‰€æœ‰åœ–ç‰‡æ‰“åŒ…æˆä¸€ä»½ Google æ–‡ä»¶ã€‚
            </p>
            <p class="text-sm text-gray-500 mt-3">
                <strong>ç³»çµ±åŸç†ï¼š</strong> æ­¤å·¥å…·åˆ©ç”¨ Google Apps Script å»ºç«‹ä¸€å€‹å°ˆå±¬æ–¼ä½ çš„ Web App (å¼•æ“)ï¼Œä¸¦é€éç€è¦½å™¨æ›¸ç±¤ (æŒ‰éˆ•) ä¾†å‘¼å«å®ƒã€‚
            </p>
        </div>

        <!-- æ­¥é©Ÿå€ -->
        <div class="space-y-6">
            
            <!-- æ­¥é©Ÿ 1 (ä¿®æ”¹ç‰ˆ) -->
            <div class="step-card p-5">
                <div class="flex items-start space-x-4">
                    <div class="step-number">1</div>
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-3">å»ºç«‹å¼•æ“ (äºŒé¸ä¸€)</h3>
                        
                        <!-- é¸é … A: å¾ç¯„æœ¬ (æ¨è–¦) -->
                        <div class="border border-gray-200 rounded-lg p-4">
                            <h4 class="text-lg font-semibold text-gray-700">é¸é … Aï¼šå¾ç¯„æœ¬å»ºç«‹ (æ¨è–¦)</h4>
                            <p class="mt-2 text-gray-700">
                                1. é»æ“Šä¸‹æ–¹é€£çµï¼Œå–å¾—ã€ŒSOP 3.0 æ“ä½œé¢æ¿ã€Google Sheet ç¯„æœ¬ï¼š
                                <br>
                                <!-- *** å·²æ›´æ–°çš„é€£çµ *** -->
                                <a href="https://docs.google.com/spreadsheets/d/15qeS0vj81h9sQ58FklwbbrV6RWC7l1KfoDlYWNBuJNk/edit?usp=sharing" target="_blank" rel="noopener noreferrer" class="code-block mt-1 inline-block text-blue-600 hover:text-blue-800 hover:underline break-all">
                                    https://docs.google.com/spreadsheets/d/15qeS0vj81h9sQ58FklwbbrV6RWC7l1KfoDlYWNBuJNk/edit?usp=sharing
                                </a>
                                <br>
                                2. åœ¨ä½ çš„ Google å¸³è™Ÿä¸‹ã€Œ<strong>å»ºç«‹å‰¯æœ¬</strong>ã€ã€‚
                                <br>
                                3. <span class="text-sm text-gray-500">(ä½ å»ºç«‹çš„ Sheet å‰¯æœ¬ï¼Œå°±æ˜¯æœªä¾†æ­¤å·¥å…·çš„ã€Œå¼•æ“å®¤ã€ï¼Œè«‹å‹¿åˆªé™¤ã€‚)</span>
                                <br>
                                4. <strong>å®Œæˆæ­¤é¸é …å¾Œï¼Œè«‹ç›´æ¥è·³è‡³ã€Œæ­¥é©Ÿ 2ã€ã€‚</strong>
                            </p>
                        </div>

                        <!-- åˆ†éš”ç·š -->
                        <div class="relative my-6">
                            <div class="absolute inset-0 flex items-center" aria-hidden="true">
                                <div class="w-full border-t border-gray-300"></div>
                            </div>
                            <div class="relative flex justify-center">
                                <span class="px-2 bg-white text-sm font-medium text-gray-500">æˆ–</span>
                            </div>
                        </div>

                        <!-- é¸é … B: å¾é›¶æ‰‹å‹•å»ºç«‹ -->
                        <div class="border border-gray-200 rounded-lg p-4">
                            <h4 class="text-lg font-semibold text-gray-700">é¸é … Bï¼šå¾é›¶æ‰‹å‹•å»ºç«‹ (é€²éš)</h4>
                            <p class="mt-2 text-gray-700 mb-2">
                                å¦‚æœä½ ä¸æƒ³ä½¿ç”¨ç¯„æœ¬ï¼Œæˆ–ç¯„æœ¬é€£çµå¤±æ•ˆï¼Œä½ å¯ä»¥æ‰‹å‹•å»ºç«‹ï¼š
                            </p>
                            <ol class="list-decimal list-inside mt-2 text-gray-700 space-y-2">
                                <li>åœ¨ç€è¦½å™¨é–‹å•Ÿ <code class="code-block">sheets.new</code> å»ºç«‹ä¸€ä»½æ–°çš„ Google è©¦ç®—è¡¨ã€‚</li>
                                <li>å°‡å®ƒå‘½åç‚ºã€Œåœ–ç‰‡æ‰“åŒ…å·¥å…· - å¼•æ“å®¤ã€(æˆ–ä»»ä½•ä½ è¨˜å¾—çš„åç¨±)ã€‚</li>
                                <li>é»æ“Š <code class="code-block">æ“´å……åŠŸèƒ½</code> &gt; <code class="code-block">Apps Script</code>ã€‚</li>
                                <li>(é¸å¡«) å°‡ Apps Script å°ˆæ¡ˆæ”¹åç‚ºã€Œåœ–ç‰‡æ‰“åŒ… Web Appã€ã€‚</li>
                                <li>åˆªé™¤ <code class="code-block">Code.gs</code> æª”æ¡ˆä¸­çš„æ‰€æœ‰é è¨­ç¨‹å¼ç¢¼ã€‚</li>
                                <li><strong>å®Œæ•´è¤‡è£½</strong>ä¸¦<strong>è²¼ä¸Š</strong>ä»¥ä¸‹çš„ Web App ç¨‹å¼ç¢¼ï¼š
                                    <textarea readonly class="code-textarea w-full mt-2 p-3 rounded-md" rows="15">
/**
 * (Web App ç‰ˆæœ¬)
 * æ¥æ”¶ä¾†è‡ª GET è«‹æ±‚çš„ Google Drive è³‡æ–™å¤¾ URLï¼Œ
 * å°‡è©²è³‡æ–™å¤¾ä¸­çš„åœ–ç‰‡æ‰“åŒ…æˆä¸€ä»½ Google æ–‡ä»¶ã€‚
 */
function doGet(e) {
  var folderUrl = e.parameter.folderUrl; // å¾æ›¸ç±¤å‚³ä¾†çš„åƒæ•¸
  
  // 1. æª¢æŸ¥ URL æ˜¯å¦å­˜åœ¨
  if (!folderUrl) {
    return ContentService.createTextOutput("éŒ¯èª¤ï¼šæœªæä¾› folderUrl åƒæ•¸ã€‚");
  }

  try {
    // 2. æå– Folder ID
    var folderId = extractFolderIdFromUrl(folderUrl);
    
    if (!folderId) {
      throw new Error("ç„¡æ³•å¾ç¶²å€ä¸­è¾¨è­˜å‡º Folder IDã€‚è«‹ç¢ºèªç¶²å€æ˜¯å¦æ­£ç¢ºã€‚");
    }

    // 3. ç²å–ä¾†æºè³‡æ–™å¤¾
    var sourceFolder = DriveApp.getFolderById(folderId);
    var folderName = sourceFolder.getName();

    // 4. å»ºç«‹æ–°çš„ Google æ–‡ä»¶
    var docName = folderName + " - åœ–ç‰‡å½™æ•´ (" + new Date().toLocaleString('sv') + ")";
    var doc = DocumentApp.create(docName);
    var body = doc.getBody();
    
    // å°‡æ–°æ–‡ä»¶ç§»å‹•åˆ°ä¾†æºè³‡æ–™å¤¾ä¸­
    DriveApp.getFileById(doc.getId()).moveTo(sourceFolder);

    body.appendParagraph(docName).setHeading(DocumentApp.ParagraphHeading.HEADING1);
    body.appendParagraph("æ­¤æ–‡ä»¶ç”±ã€Œä¸€éµæ‰“åŒ…æ›¸ç±¤ã€è‡ªå‹•ç”Ÿæˆã€‚\nä¾†æºè³‡æ–™Kå¤¾ï¼š" + folderName);
    body.appendHorizontalRule();

    // 5. éæ­·æª”æ¡ˆä¸¦æ’å…¥åœ–ç‰‡
    var files = sourceFolder.getFiles();
    var imageCount = 0;

    while (files.hasNext()) {
      var file = files.next();
      var mimeType = file.getMimeType();

      if (mimeType.startsWith('image/')) {
        var imageBlob = file.getBlob();
        body.appendParagraph(file.getName()).setHeading(DocumentApp.ParagraphHeading.HEADING3);
        body.appendImage(imageBlob);
        body.appendParagraph("\n"); 
        imageCount++;
      }
    }

    // 6. å¯«å…¥ç¸½çµä¸¦å„²å­˜
    body.appendHorizontalRule();
    body.appendParagraph("è™•ç†å®Œæˆã€‚å…±æ’å…¥ " + imageCount + " å¼µåœ–ç‰‡ã€‚");
    doc.saveAndClose();
    
    // 7. å›å ±æˆåŠŸè¨Šæ¯ (é€™æœƒé¡¯ç¤ºåœ¨æ–°é–‹çš„ç¶²é åˆ†é ä¸Š)
    var successMessage = "âœ… æˆåŠŸï¼\n\nå·²å»ºç«‹æ–‡ä»¶ '" + docName + "'\nå…§å« " + imageCount + " å¼µåœ–ç‰‡ã€‚\n\næ–‡ä»¶å·²å­˜å›åŸè³‡æ–™å¤¾ï¼Œä½ ç¾åœ¨å¯ä»¥é—œé–‰æ­¤åˆ†é äº†ã€‚";
    return ContentService.createTextOutput(successMessage);

  } catch (err) {
    // éŒ¯èª¤è™•ç†
    Logger.log(err.toString());
    return ContentService.createTextOutput("âŒ ç™¼ç”ŸéŒ¯èª¤ï¼š\n\n" + err.message + "\n\nè«‹æª¢æŸ¥ Google Drive ç¶²å€æ˜¯å¦æ­£ç¢ºï¼Œä»¥åŠè…³æœ¬æ¬Šé™ã€‚");
  }
}

/**
 * è¼”åŠ©å·¥å…·ï¼šå¾ Google Drive URL ä¸­æå– Folder ID
 * @param {string} url - Google Drive çš„ç¶²å€
 * @return {string} - Folder ID
 */
function extractFolderIdFromUrl(url) {
  var id = null;
  // è™•ç† .../folders/FOLDER_ID æ ¼å¼ (åŒ…å« /u/0/, /u/1/ ç­‰)
  var match = url.match(/\/folders\/([a-zA-Z0-9_-]+)/);
  if (match && match[1]) {
    id = match[1];
  } else {
    // è™•ç† ...id=FOLDER_ID æ ¼å¼ (ä¾‹å¦‚åˆ†äº«é€£çµ)
    match = url.match(/id=([a-zA-Z0-9_-]+)/);
    if (match && match[1]) {
      id = match[1];
    }
  }
  return id;
}

/**
 * è¼”åŠ©å·¥å…·ï¼šå»ºç«‹é¸å–® (å¯é¸ï¼Œä¿ç•™å®ƒå¯ä»¥è®“ä½ å¾ Sheet ä»‹é¢æ¸¬è©¦)
 */
function onOpen() {
  var ui = SpreadsheetApp.getUi();
  ui.createMenu('æ‰“åŒ…å·¥å…· (æ‰‹å‹•)')
      .addItem('1. æ¸¬è©¦ (è®€å– A1)', 'testFromSheet')
      .addToUi();
}

/**
 * è¼”åŠ©å·¥å…·ï¼šå¾ Sheet æ¸¬è©¦ doGet é‚è¼¯
 */
function testFromSheet() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var urlCell = sheet.getRange('A1');
  var statusCell = sheet.getRange('A2');
  var folderUrl = urlCell.getValue();
  
  // æ¨¡æ“¬ doGet çš„åƒæ•¸
  var mockEvent = {
    parameter: {
      folderUrl: folderUrl
    }
  };
  
  // å‘¼å« doGet ä¸¦ç²å–å›å‚³çš„æ–‡å­—
  var response = doGet(mockEvent).getContent();
  statusCell.setValue(response);
  SpreadsheetApp.getUi().alert(response);
}
                                    </textarea>
                                </li>
                                <li>é»æ“Šã€Œ<strong>å„²å­˜</strong>ã€åœ–ç¤ºã€‚</li>
                                <li><strong>å®Œæˆæ­¤é¸é …å¾Œï¼Œè«‹ç¹¼çºŒã€Œæ­¥é©Ÿ 2ã€ã€‚</strong></li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ­¥é©Ÿ 2 (åŸ 4-8) -->
            <div class="step-card p-5">
                <div class="flex items-start space-x-4">
                    <div class="step-number">2</div>
                    <div>
                        <h3 class="text-xl font-bold text-gray-800">éƒ¨ç½² Web App (å¼•æ“)</h3>
                        <ol class="list-decimal list-inside mt-2 text-gray-700 space-y-1.5">
                            <li>åœ¨ä½ çš„ Apps Script ç·¨è¼¯å™¨ä¸­ï¼Œé»æ“Šå³ä¸Šè§’çš„è—è‰²æŒ‰éˆ•ã€Œ<strong>éƒ¨ç½²</strong>ã€&gt;ã€Œ<strong>æ–°å¢éƒ¨ç½²ä½œæ¥­</strong>ã€ã€‚</li>
                            <li>åœ¨ã€Œé¸å–é¡å‹ã€æ—é»æ“Šé½’è¼ªåœ–ç¤ºï¼Œé¸æ“‡ã€Œ<strong>ç¶²è·¯æ‡‰ç”¨ç¨‹å¼</strong>ã€ã€‚</li>
                            <li>ç¢ºèªä»¥ä¸‹è¨­å®šï¼š
                                <ul class="list-disc list-inside ml-6 my-2 p-3 bg-blue-50 rounded-md border border-blue-200">
                                    <li><strong>åŸ·è¡Œè€…ï¼š</strong> é¸æ“‡ã€Œ<strong>æˆ‘ (ä½ çš„ Email)</strong>ã€</li>
                                    <li><strong>èª°å¯ä»¥å­˜å–ï¼š</strong> é¸æ“‡ã€Œ<strong>åƒ…é™æˆ‘è‡ªå·±</strong>ã€</li>
                                </ul>
                            </li>
                            <li>é»æ“Šã€Œ<strong>éƒ¨ç½²</strong>ã€ã€‚</li>
                            <li>
                                ç•«é¢æœƒå½ˆå‡ºã€Œéœ€è¦æˆæ¬Šã€ï¼Œè«‹é»æ“Šã€Œ<strong>å¯©æŸ¥æ¬Šé™</strong>ã€ã€‚
                                <br>
                                <span class="text-sm text-gray-500">(ä¾åºé¸æ“‡ä½ çš„å¸³è™Ÿ &gt; é€²éš &gt; å‰å¾€...(ä¸å®‰å…¨) &gt; å…è¨±)</span>
                            </li>
                        </ol>
                    </div>
                </div>
            </div>

            <!-- æ­¥é©Ÿ 3 (åŸ 9) (äº’å‹•) -->
            <div class="step-card p-5 border-2 border-blue-500 shadow-lg">
                <div class="flex items-start space-x-4">
                    <div class="step-number">3</div>
                    <div>
                        <h3 class="text-xl font-bold text-blue-700">è²¼ä¸Š Web App ç¶²å€</h3>
                        <p class="mt-2 text-gray-700 mb-3">
                            éƒ¨ç½²æˆåŠŸå¾Œï¼Œæœƒé¡¯ç¤ºä¸€å€‹ã€Œç¶²è·¯æ‡‰ç”¨ç¨‹å¼ç¶²å€ã€ã€‚è«‹<strong>å®Œæ•´è¤‡è£½</strong>è©²ç¶²å€ï¼Œä¸¦è²¼åˆ°ä¸‹æ–¹çš„è¼¸å…¥æ¡†ä¸­ã€‚
                        </p>
                        <label for="webAppUrlInput" class="block text-sm font-medium text-gray-700 mb-1">è²¼ä¸Šä½ çš„ã€Œç¶²è·¯æ‡‰ç”¨ç¨‹å¼ç¶²å€ã€ï¼š</label>
                        <input type="text" id="webAppUrlInput" class="w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" placeholder="https://script.google.com/macros/s/...">
                    </div>
                </div>
            </div>

            <!-- æ­¥é©Ÿ 4 (åŸ 10) (äº’å‹•) -->
            <div class="step-card p-5 border-2 border-green-500 shadow-lg">
                <div class="flex items-start space-x-4">
                    <div class="step-number bg-green-600">4</div>
                    <div>
                        <h3 class="text-xl font-bold text-green-700">ç”¢ç”Ÿä¸¦è¤‡è£½æ›¸ç±¤ä»£ç¢¼</h3>
                        <p class="mt-2 text-gray-700 mb-3">
                            ä¸‹æ–¹çš„æ–‡å­—æ¡†å·²è‡ªå‹•ç”¢ç”Ÿå°ˆå±¬æ–¼ä½ çš„ã€Œæ›¸ç±¤ä»£ç¢¼ã€ã€‚è«‹é»æ“ŠæŒ‰éˆ•**ä¸€éµè¤‡è£½**ã€‚
                        </p>
                        <label for="bookmarkletOutput" class="block text-sm font-medium text-gray-700 mb-1">è‡ªå‹•ç”¢ç”Ÿçš„æ›¸ç±¤ä»£ç¢¼ï¼š</label>
                        <textarea id="bookmarkletOutput" rows="5" class="w-full p-2 border border-gray-300 rounded-md bg-gray-50 font-mono text-sm" readonly></textarea>
                        <button id="copyButton" class="mt-3 px-4 py-2 bg-green-600 text-white font-semibold rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2">
                            è¤‡è£½ä»£ç¢¼
                        </button>
                    </div>
                </div>
            </div>

            <!-- æ­¥é©Ÿ 5 (åŸ 11) -->
            <div class="step-card p-5">
                <div class="flex items-start space-x-4">
                    <div class="step-number">5</div>
                    <div>
                        <h3 class="text-xl font-bold text-gray-800">å»ºç«‹æ›¸ç±¤ (æŒ‰éˆ•)</h3>
                        <ol class="list-decimal list-inside mt-2 text-gray-700 space-y-1.5">
                            <li>åœ¨ä½ çš„ç€è¦½å™¨ã€Œæ›¸ç±¤åˆ—ã€ä¸ŠæŒ‰å³éµã€‚</li>
                            <li>é¸æ“‡ã€Œ<strong>æ–°å¢æ›¸ç±¤...</strong>ã€(æˆ–ã€ŒåŠ å…¥é é¢...ã€)ã€‚</li>
                            <li>åœ¨ã€Œ<strong>åç¨±</strong>ã€æ¬„ä½ï¼Œè¼¸å…¥ä¸€å€‹ä½ å–œæ­¡çš„åå­— (ä¾‹å¦‚ï¼š<code class="code-block">ğŸ“¦ æ‰“åŒ…åœ–ç‰‡</code>)ã€‚</li>
                            <li>åœ¨ã€Œ<strong>ç¶²å€</strong>ã€æ¬„ä½ï¼Œ**è²¼ä¸Š**ä½ å‰›å‰›å¾ã€Œæ­¥é©Ÿ 4ã€è¤‡è£½çš„å®Œæ•´ä»£ç¢¼ (å®ƒæœƒä»¥ `javascript:...` é–‹é ­)ã€‚</li>
                            <li>é»æ“Šã€Œ<strong>å„²å­˜</strong>ã€ã€‚</li>
                        </ol>
                    </div>
                </div>
            </div>

            <!-- æ­¥é©Ÿ 6 (åŸ 12) -->
            <div class="step-card p-5 bg-blue-50 border-blue-200">
                <div class="flex items-start space-x-4">
                    <div class="step-number">âœ…</div>
                    <div>
                        <h3 class="text-xl font-bold text-gray-800">éƒ¨ç½²å®Œæˆï¼</h3>
                        <p class="mt-2 text-gray-700">
                            æœªä¾†ï¼Œç•¶ä½ è¦æ‰“åŒ…åœ–ç‰‡æ™‚ï¼Œåªéœ€ï¼š
                            <br>
                            1. åœ¨ Google é›²ç«¯ç¡¬ç¢Ÿ**é€²å…¥**é‚£å€‹åœ–ç‰‡è³‡æ–™å¤¾ã€‚
                            <br>
                            2. **é»æ“Š**æ›¸ç±¤åˆ—ä¸Šçš„ã€ŒğŸ“¦ æ‰“åŒ…åœ–ç‰‡ã€æŒ‰éˆ•ã€‚
                            <br>
                            3. ä¸€ä»½æ‰“åŒ…å¥½çš„ Google æ–‡ä»¶å°±æœƒè‡ªå‹•å‡ºç¾åœ¨è©²è³‡æ–™å¤¾ä¸­ã€‚
                        </p>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        const input = document.getElementById('webAppUrlInput');
        const output = document.getElementById('bookmarkletOutput');
        const copyButton = document.getElementById('copyButton');

        function generateBookmarklet() {
            const webAppUrl = input.value.trim();
            if (!webAppUrl) {
                output.value = 'è«‹åœ¨ã€Œæ­¥é©Ÿ 3ã€è²¼ä¸Šä½ çš„ Web App ç¶²å€...';
                return;
            }
            
            // é€™è£¡ä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²å’Œ \n ä¾†æ›è¡Œï¼Œä½†åœ¨ javascript: å”è­°ä¸­æ›è¡Œæœƒè¢«å¿½ç•¥ï¼Œæ‰€ä»¥æ˜¯å®‰å…¨çš„ã€‚
            // é—œéµæ˜¯ alert ä¸­çš„ \n å¿…é ˆæ˜¯é›™åæ–œç·š \\n æ‰èƒ½åœ¨æœ€çµ‚çš„å­—ç¬¦ä¸²ä¸­æ­£ç¢ºè½‰ç¾©ã€‚
            const bookmarkletCode = `javascript:(function(){var webAppUrl='${webAppUrl}';var currentUrl=window.location.href;if(!(currentUrl.includes('drive.google.com') && currentUrl.includes('/folders/'))){alert('éŒ¯èª¤ï¼š\\n\\nè«‹å…ˆé€²å…¥ä¸€å€‹ Google é›²ç«¯ç¡¬ç¢Ÿçš„ã€Œè³‡æ–™å¤¾ã€é é¢ï¼Œç„¶å¾Œå†é»æ“Šæ­¤æ›¸ç±¤ã€‚');return;}var fullRequestUrl=webAppUrl+'?folderUrl='+encodeURIComponent(currentUrl);window.open(fullRequestUrl,'_blank');})();`;
            
            output.value = bookmarkletCode;
        }

        function copyToClipboard() {
            output.select();
            
            // ä½¿ç”¨ document.execCommand ä½œç‚ºå‚™ç”¨æ–¹æ¡ˆ
            try {
                document.execCommand('copy');
                copyButton.innerText = 'è¤‡è£½æˆåŠŸï¼';
                setTimeout(() => { copyButton.innerText = 'è¤‡è£½ä»£ç¢¼'; }, 2000);
            } catch (err) {
                copyButton.innerText = 'è¤‡è£½å¤±æ•—';
                alert('è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¤‡è£½ã€‚');
            }
        }

        input.addEventListener('input', generateBookmarklet);
        copyButton.addEventListener('click', copyToClipboard);

        // åˆå§‹åŒ–
        generateBookmarklet();
    </script>
</body>
</html>

